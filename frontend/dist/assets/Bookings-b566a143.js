import{e as $,r as h,P as C,z as u,j as e,L as E,i as I,a9 as T,v as P,Y as p,a1 as z,aa as K,U as O,$ as U}from"./index-2ba54131.js";const V=()=>{$();const[s,S]=h.useState("all"),[r,B]=h.useState(""),[o,y]=h.useState([]),[D,b]=h.useState(!0);h.useEffect(()=>{f()},[]);const f=async()=>{try{b(!0);const t=await C.get("/bookings");y(t.data.data.bookings||[])}catch(t){console.error("Error fetching bookings:",t),y(L()),u.error("Failed to load bookings. Showing demo data.")}finally{b(!1)}},L=()=>[{_id:"BK001",room:{_id:"room1",title:"Cozy Student Room",address:{area:"Koramangala",city:"Bangalore"},photos:[{url:"https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=300&h=200&fit=crop"}]},checkInDate:"2024-01-15",checkOutDate:"2024-06-15",totalAmount:42500,status:"confirmed",paymentStatus:"paid",createdAt:"2024-01-01",duration:5},{_id:"BK002",room:{_id:"room2",title:"Modern Mess Accommodation",address:{area:"Whitefield",city:"Bangalore"},photos:[{url:"https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=300&h=200&fit=crop"}]},checkInDate:"2024-02-01",checkOutDate:"2024-07-01",totalAmount:36e3,status:"pending",paymentStatus:"pending",createdAt:"2024-01-20",duration:5},{_id:"BK003",room:{_id:"room3",title:"Budget Friendly Room",address:{area:"BTM Layout",city:"Bangalore"},photos:[{url:"https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=300&h=200&fit=crop"}]},checkInDate:"2023-08-01",checkOutDate:"2023-12-31",totalAmount:2e4,status:"completed",paymentStatus:"paid",createdAt:"2023-07-15",duration:5}],A=async t=>{if(window.confirm("Are you sure you want to cancel this booking?"))try{await C.delete(`/bookings/${t}`),u.success("Booking cancelled successfully"),f()}catch(a){console.error("Error cancelling booking:",a),u.error("Failed to cancel booking")}},F=async t=>{try{u.success("Receipt download started")}catch(a){console.error("Error downloading receipt:",a),u.error("Failed to download receipt")}},_=t=>{switch(t){case"confirmed":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"cancelled":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";case"completed":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},R=t=>{switch(t){case"paid":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"failed":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},w=o.filter(t=>{var l,d,n,c,i,x,m,g;const a=((d=(l=t.room)==null?void 0:l.title)==null?void 0:d.toLowerCase().includes(r.toLowerCase()))||((i=(c=(n=t.room)==null?void 0:n.address)==null?void 0:c.area)==null?void 0:i.toLowerCase().includes(r.toLowerCase()))||((g=(m=(x=t.room)==null?void 0:x.address)==null?void 0:m.city)==null?void 0:g.toLowerCase().includes(r.toLowerCase()))||t._id.toLowerCase().includes(r.toLowerCase());return s==="all"?a:a&&t.status===s}),M=[{id:"all",label:"All Bookings",count:o.length},{id:"confirmed",label:"Confirmed",count:o.filter(t=>t.status==="confirmed").length},{id:"pending",label:"Pending",count:o.filter(t=>t.status==="pending").length},{id:"completed",label:"Completed",count:o.filter(t=>t.status==="completed").length}];return D?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center pt-24",children:e.jsx(E,{size:"large",text:"Loading your bookings..."})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-24 pb-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"My Bookings"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage and track all your accommodation bookings"})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-8 transition-colors duration-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(I,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search bookings by property, location, or booking ID...",value:r,onChange:t=>B(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500 dark:bg-gray-700 dark:text-white transition-colors duration-200"})]}),e.jsxs("button",{className:"flex items-center px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"More Filters"]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md mb-6 transition-colors duration-200",children:e.jsx("div",{className:"flex flex-wrap border-b border-gray-200 dark:border-gray-700",children:M.map(t=>e.jsxs("button",{onClick:()=>S(t.id),className:`flex items-center px-6 py-4 text-sm font-medium transition-colors ${s===t.id?"text-purple-600 dark:text-purple-400 border-b-2 border-purple-600 dark:border-purple-400":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[e.jsx("span",{children:t.label}),e.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 rounded-full",children:t.count})]},t.id))})}),w.length>0?e.jsx("div",{className:"space-y-6",children:w.map(t=>{var a,l,d,n,c,i,x,m,g,k,j,N;return e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-all duration-200",children:e.jsxs("div",{className:"flex flex-col lg:flex-row",children:[e.jsx("div",{className:"lg:w-64 h-48 lg:h-auto",children:e.jsx("img",{src:((d=(l=(a=t.room)==null?void 0:a.photos)==null?void 0:l[0])==null?void 0:d.url)||"https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=300&h=200&fit=crop",alt:((n=t.room)==null?void 0:n.title)||"Room",className:"w-full h-full object-cover"})}),e.jsx("div",{className:"flex-1 p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex-1 mb-4 lg:mb-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-1",children:((c=t.room)==null?void 0:c.title)||"Room"}),e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400 mb-2",children:[e.jsx(P,{className:"w-4 h-4 mr-1"}),e.jsxs("span",{className:"text-sm",children:[(x=(i=t.room)==null?void 0:i.address)==null?void 0:x.area,", ",(g=(m=t.room)==null?void 0:m.address)==null?void 0:g.city]})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${_(t.status)}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["ID: ",t._id]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Check-in"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:new Date(t.checkInDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Check-out"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:new Date(t.checkOutDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Total Amount"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["â‚¹",(k=t.totalAmount)==null?void 0:k.toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 mr-2",children:"Payment:"}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${R(t.paymentStatus)}`,children:((j=t.paymentStatus)==null?void 0:j.charAt(0).toUpperCase())+((N=t.paymentStatus)==null?void 0:N.slice(1))})]}),e.jsxs("div",{className:"flex items-center text-gray-500 dark:text-gray-400",children:[e.jsx(K,{className:"w-4 h-4 mr-1"}),e.jsxs("span",{className:"text-sm",children:["Booked on ",new Date(t.createdAt).toLocaleDateString()]})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2 lg:ml-6",children:[e.jsxs("button",{onClick:()=>{var v;return window.location.href=`/rooms/${(v=t.room)==null?void 0:v._id}`},className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors text-sm",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"View Details"]}),e.jsxs("button",{onClick:()=>F(t._id),className:"flex items-center px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors text-sm",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Download Receipt"]}),t.status==="pending"&&e.jsx("button",{onClick:()=>A(t._id),className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm",children:"Cancel Booking"})]})]})})]})},t._id)})}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-12 text-center transition-colors duration-200",children:[e.jsx(p,{className:"w-16 h-16 text-gray-400 dark:text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No bookings found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:r?`No bookings match your search "${r}"`:s==="all"?"You haven't made any bookings yet":`No ${s} bookings found`}),e.jsx("button",{onClick:()=>window.location.href="/rooms",className:"px-6 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Browse Rooms"})]})]})})};export{V as default};
