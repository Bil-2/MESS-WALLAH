import{r as p,u as M,e as W,j as e,m as l,R as z,o as U,S as v,O as _,N as H,E as C,x as Z,T as A,U as F,h as B,d as G,Q as J,V as Q,z as f}from"./index-2ba54131.js";import{A as K}from"./index-4cfa389c.js";const X=(r,m,x)=>{const d=p.useRef(null),b=p.useRef(null);return p.useEffect(()=>{m({...x});const g=()=>{if(d.current){const n=d.current,o="form_"+Math.random().toString(36).substr(2,9);n.setAttribute("name",o),n.setAttribute("id",o),n.querySelectorAll("input").forEach((h,S)=>{h.name+""+Math.random().toString(36).substr(2,5),h.setAttribute("data-original-name",h.name),h.setAttribute("autocomplete","new-password");const c=document.createElement("input");c.type="text",c.style.position="absolute",c.style.left="-9999px",c.style.opacity="0",c.style.pointerEvents="none",c.tabIndex=-1,c.name=h.name+"_fake",c.autocomplete="off",h.parentNode.insertBefore(c,h)})}},a=()=>{setTimeout(()=>{m({...x}),d.current&&d.current.querySelectorAll("input").forEach(o=>{o.type!=="hidden"&&o.type!=="submit"&&(o.value="",o.defaultValue="")})},100),setTimeout(()=>{m({...x})},500),setTimeout(()=>{m({...x})},1e3)};g(),a();const s=setInterval(()=>{if(d.current){const n=d.current.querySelectorAll("input");let o=!1;n.forEach(u=>{u.value&&u.value!==r[u.name]&&(o=!0)}),o&&(console.log("Auto-fill detected, clearing..."),m({...x}),n.forEach(u=>{u.type!=="hidden"&&u.type!=="submit"&&(u.value="")}))}},500);return setTimeout(()=>clearInterval(s),5e3),()=>{b.current&&clearTimeout(b.current),clearInterval(s)}},[]),{formRef:d,handleInputFocus:g=>{const a=g.target,y=a.name;a.value&&!r[y]&&(a.value="",m(s=>({...s,[y]:""})))},handleInputChange:g=>{const{name:a,value:y}=g.target;m(s=>({...s,[a]:y})),d.current&&d.current.querySelectorAll(`input:not([name="${a}"])`).forEach(n=>{n.value&&!r[n.name]&&(n.value="")})}}},te=()=>{const[r,m]=p.useState({name:"",email:"",phone:"",password:"",confirmPassword:"",role:"student"}),[x,d]=p.useState(!1),[b,P]=p.useState(!1),[N,g]=p.useState(!1),[a,y]=p.useState({}),[s,n]=p.useState({sendingOtp:!1,otpSent:!1,showOtpInput:!1,otp:"",verifying:!1,isVerified:!1}),[o,u]=p.useState(0),h=M(),{register:S,sendOtp:c,verifyOtp:O}=W();X(r,m,{name:"",email:"",phone:"",password:"",confirmPassword:"",role:"student"});const E=t=>{let i=0;return t.length>=8&&(i+=25),/[A-Z]/.test(t)&&(i+=25),/[0-9]/.test(t)&&(i+=25),/[^A-Za-z0-9]/.test(t)&&(i+=25),i},I=()=>{const t={};return r.name.trim()||(t.name="Name is required"),r.email.trim()||(t.email="Email is required"),/\S+@\S+\.\S+/.test(r.email)||(t.email="Email is invalid"),r.phone.trim()||(t.phone="Phone number is required"),/^[6-9]\d{9}$/.test(r.phone)||(t.phone="Invalid Indian phone number"),r.password||(t.password="Password is required"),r.password.length<8&&(t.password="Password must be at least 8 characters"),r.password!==r.confirmPassword&&(t.confirmPassword="Passwords do not match"),y(t),Object.keys(t).length===0},w=t=>{const{name:i,value:j}=t.target;m(k=>({...k,[i]:j})),a[i]&&y(k=>({...k,[i]:""})),i==="password"&&u(E(j))},T=async()=>{if(!r.phone||!/^[6-9]\d{9}$/.test(r.phone)){f.error("Please enter a valid phone number");return}n(t=>({...t,sendingOtp:!0}));try{await c(r.phone),n(t=>({...t,sendingOtp:!1,otpSent:!0,showOtpInput:!0})),f.success("OTP sent successfully!")}catch(t){n(i=>({...i,sendingOtp:!1})),f.error(t.message||"Failed to send OTP")}},q=async()=>{if(!s.otp||s.otp.length!==6){f.error("Please enter a valid 6-digit OTP");return}n(t=>({...t,verifying:!0}));try{await O(r.phone,s.otp),n(t=>({...t,verifying:!1,isVerified:!0,showOtpInput:!1})),f.success("Phone number verified successfully!")}catch(t){n(i=>({...i,verifying:!1})),f.error(t.message||"Invalid OTP")}},R=t=>{const i=t.target.value.replace(/\D/g,"").slice(0,6);n(j=>({...j,otp:i}))},V=async t=>{if(t.preventDefault(),!I()){f.error("Please fix the errors below");return}if(!s.isVerified){f.error("Please verify your phone number first");return}g(!0);try{await S(r),f.success("Registration successful! Welcome to MESS WALLAH!"),h("/")}catch(i){f.error(i.message||"Registration failed")}finally{g(!1)}},$=()=>o<25?"bg-red-500":o<50?"bg-yellow-500":o<75?"bg-blue-500":"bg-green-500",L=()=>o<25?"Weak":o<50?"Fair":o<75?"Good":"Strong";return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-pink-50 to-purple-50 dark:from-gray-900 dark:via-purple-900 dark:to-gray-900 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-lg w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(l.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"mx-auto w-16 h-16 bg-gradient-to-br from-orange-500 to-pink-500 rounded-2xl flex items-center justify-center mb-4 shadow-lg",children:e.jsx(z,{className:"w-8 h-8 text-white"})}),e.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-orange-600 to-pink-600 bg-clip-text text-transparent",children:"Join MESS WALLAH"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Find your perfect accommodation today"})]}),e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"bg-white/80 dark:bg-gray-800/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 dark:border-gray-700/20 p-8",children:e.jsxs("form",{className:"space-y-6",onSubmit:V,children:[e.jsxs(l.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.4},children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"name",name:"name",type:"text",autoComplete:"off",required:!0,value:r.name,onChange:w,className:`w-full px-4 py-3 pl-10 border rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white transition-all duration-200 ${a.name?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Enter your full name"})]}),a.name&&e.jsxs(l.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-2 text-red-500 text-sm mt-1",children:[e.jsx(v,{className:"w-4 h-4"}),a.name]})]}),e.jsxs(l.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.5},children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"off",required:!0,value:r.email,onChange:w,className:`w-full px-4 py-3 pl-10 border rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white transition-all duration-200 ${a.email?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Enter your email address"})]}),a.email&&e.jsxs(l.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-2 text-red-500 text-sm mt-1",children:[e.jsx(v,{className:"w-4 h-4"}),a.email]})]}),e.jsxs(l.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.6},children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Phone Number"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"phone",name:"phone",type:"tel",autoComplete:"off",required:!0,value:r.phone,onChange:w,className:`w-full px-4 py-3 pl-10 border rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white transition-all duration-200 ${a.phone?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Enter 10-digit phone number"}),s.isVerified&&e.jsx(C,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-green-500"})]}),!s.isVerified&&e.jsx("button",{type:"button",onClick:T,disabled:s.sendingOtp||!r.phone,className:"px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:s.sendingOtp?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):s.otpSent?"Resend OTP":"Send OTP"})]}),a.phone&&e.jsxs(l.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-2 text-red-500 text-sm mt-1",children:[e.jsx(v,{className:"w-4 h-4"}),a.phone]}),e.jsx(K,{children:s.showOtpInput&&e.jsxs(l.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-3",children:[e.jsx("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Enter OTP"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{id:"otp",type:"text",value:s.otp,onChange:R,className:"flex-1 px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white text-center text-lg tracking-widest font-medium",placeholder:"000000",maxLength:"6"}),e.jsx("button",{type:"button",onClick:q,disabled:s.verifying||s.otp.length!==6,className:"px-4 py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:s.verifying?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):"Verify"})]})]})})]}),e.jsxs(l.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.7},children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"password",name:"password",type:x?"text":"password",autoComplete:"off",required:!0,value:r.password,onChange:w,className:`w-full px-4 py-3 pl-10 pr-10 border rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white transition-all duration-200 ${a.password?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Create a strong password"}),e.jsx("button",{type:"button",onClick:()=>d(!x),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:x?e.jsx(A,{className:"h-5 w-5"}):e.jsx(F,{className:"h-5 w-5"})})]}),r.password&&e.jsxs(l.div,{initial:{opacity:0},animate:{opacity:1},className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Password Strength"}),e.jsx("span",{className:`text-xs font-medium ${o<25?"text-red-500":o<50?"text-yellow-500":o<75?"text-blue-500":"text-green-500"}`,children:L()})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx(l.div,{initial:{width:0},animate:{width:`${o}%`},className:`h-2 rounded-full transition-all duration-300 ${$()}`})})]}),a.password&&e.jsxs(l.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-2 text-red-500 text-sm mt-1",children:[e.jsx(v,{className:"w-4 h-4"}),a.password]})]}),e.jsxs(l.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.8},children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:b?"text":"password",autoComplete:"off",required:!0,value:r.confirmPassword,onChange:w,className:`w-full px-4 py-3 pl-10 pr-10 border rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white transition-all duration-200 ${a.confirmPassword?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Confirm your password"}),e.jsx("button",{type:"button",onClick:()=>P(!b),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:b?e.jsx(A,{className:"h-5 w-5"}):e.jsx(F,{className:"h-5 w-5"})}),r.confirmPassword&&r.password===r.confirmPassword&&e.jsx(C,{className:"absolute right-10 top-1/2 transform -translate-y-1/2 h-5 w-5 text-green-500"})]}),a.confirmPassword&&e.jsxs(l.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-2 text-red-500 text-sm mt-1",children:[e.jsx(v,{className:"w-4 h-4"}),a.confirmPassword]})]}),e.jsx(l.button,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.9},type:"submit",disabled:N||!s.isVerified,className:"w-full flex justify-center items-center py-4 px-6 border border-transparent text-base font-semibold rounded-xl text-white bg-gradient-to-r from-orange-600 to-pink-600 hover:from-orange-700 hover:to-pink-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:N?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}),"Creating Account..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-5 h-5 mr-2"}),"Create Account"]})}),e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"text-center pt-4",children:e.jsxs(J,{to:"/login",className:"inline-flex items-center text-sm text-orange-600 hover:text-orange-500 dark:text-orange-400 dark:hover:text-orange-300 font-medium transition-colors group",children:["Already have an account? Sign in",e.jsx(Q,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})})]})})]})})};export{te as default};
