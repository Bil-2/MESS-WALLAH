import{r,u as q,f as A,z as c,j as e,S as V,Q as f,I as M,E as O,x as W,T as C,U as S,P as Y}from"./index-2ba54131.js";const B=()=>{const[o,w]=r.useState(""),[p,b]=r.useState(""),[m,E]=r.useState(!1),[g,F]=r.useState(!1),[y,k]=r.useState(!1),[R,j]=r.useState(!1),[I,N]=r.useState(null),[l,x]=r.useState({}),u=q(),[T]=A(),a=T.get("token");r.useEffect(()=>{if(w(""),b(""),x({}),j(!1),!a){c.error("Invalid reset link"),u("/forgot-password");return}try{if(!a||a.length<10)throw new Error("Token too short");const t=a.split(".").length===3,i=/^[a-f0-9]+$/i.test(a)&&a.length>=32;if(!t&&!i)throw new Error("Invalid token format");N(!0)}catch{N(!1),c.error("Invalid or expired reset link")}},[a,u]);const $=s=>{const t=[];return s.length<8&&t.push("Password must be at least 8 characters long"),/(?=.*[a-z])/.test(s)||t.push("Password must contain at least one lowercase letter"),/(?=.*[A-Z])/.test(s)||t.push("Password must contain at least one uppercase letter"),/(?=.*\d)/.test(s)||t.push("Password must contain at least one number"),/(?=.*[@$!%*?&])/.test(s)||t.push("Password must contain at least one special character"),t},z=s=>{let t=0;return s.length>=8&&t++,s.length>=12&&t++,/(?=.*[a-z])/.test(s)&&t++,/(?=.*[A-Z])/.test(s)&&t++,/(?=.*\d)/.test(s)&&t++,/(?=.*[@$!%*?&])/.test(s)&&t++,t<=2?{strength:"weak",color:"bg-red-500",text:"Weak"}:t<=4?{strength:"medium",color:"bg-yellow-500",text:"Medium"}:{strength:"strong",color:"bg-green-500",text:"Strong"}},L=async s=>{var v,P;s.preventDefault(),x({});const t=$(o),i={};if(t.length>0&&(i.password=t),o!==p&&(i.confirmPassword=["Passwords do not match"]),Object.keys(i).length>0){x(i);return}try{k(!0);const d=await Y.post("/auth/reset-password",{token:a,newPassword:o});d.data.success?(j(!0),c.success("Password reset successfully!")):c.error(d.data.message||"Failed to reset password")}catch(d){console.error("Reset password error:",d);const h=((P=(v=d.response)==null?void 0:v.data)==null?void 0:P.message)||d.message||"Failed to reset password";c.error(h),(h.includes("expired")||h.includes("invalid"))&&setTimeout(()=>{u("/forgot-password")},3e3)}finally{k(!1)}};if(I===!1)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-white to-orange-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(V,{className:"w-8 h-8 text-red-600 dark:text-red-400"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Invalid Reset Link"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"This password reset link is invalid or has expired. Please request a new one."}),e.jsxs(f,{to:"/forgot-password",className:"inline-flex items-center px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Request New Link"]})]})});if(R)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-white to-orange-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(O,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Password Reset Successfully!"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Your password has been updated. You can now sign in with your new password."}),e.jsx(f,{to:"/login",className:"inline-flex items-center px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:"Sign In Now"})]})});const n=o?z(o):null;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-pink-50 to-purple-50 dark:from-gray-900 dark:via-purple-900 dark:to-gray-900 flex items-center justify-center pt-24 pb-6 px-4 relative overflow-hidden fade-in",children:e.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-orange-100 dark:bg-orange-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(W,{className:"w-8 h-8 text-orange-600 dark:text-orange-400"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Reset Password"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Enter your new password below"})]}),e.jsxs("form",{onSubmit:L,className:"space-y-6",autoComplete:"off",noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",type:m?"text":"password",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",value:o,onChange:s=>w(s.target.value),className:`w-full px-4 py-3 pr-12 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-colors ${l.password?"border-red-300":"border-gray-300"} dark:bg-gray-700 dark:border-gray-600 dark:text-white`,placeholder:"Enter new password",required:!0}),e.jsx("button",{type:"button",onClick:()=>E(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:m?e.jsx(C,{className:"w-5 h-5"}):e.jsx(S,{className:"w-5 h-5"})})]}),o&&n&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Password strength:"}),e.jsx("span",{className:`font-medium ${n.strength==="weak"?"text-red-600":n.strength==="medium"?"text-yellow-600":"text-green-600"}`,children:n.text})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2 mt-1",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${n.color}`,style:{width:n.strength==="weak"?"33%":n.strength==="medium"?"66%":"100%"}})})]}),l.password&&e.jsx("div",{className:"mt-2 space-y-1",children:l.password.map((s,t)=>e.jsxs("p",{className:"text-sm text-red-600 dark:text-red-400",children:["• ",s]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"confirmPassword",type:g?"text":"password",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",value:p,onChange:s=>b(s.target.value),className:`w-full px-4 py-3 pr-12 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-colors ${l.confirmPassword?"border-red-300":"border-gray-300"} dark:bg-gray-700 dark:border-gray-600 dark:text-white`,placeholder:"Confirm new password",required:!0}),e.jsx("button",{type:"button",onClick:()=>F(!g),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:g?e.jsx(C,{className:"w-5 h-5"}):e.jsx(S,{className:"w-5 h-5"})})]}),l.confirmPassword&&e.jsx("div",{className:"mt-2 space-y-1",children:l.confirmPassword.map((s,t)=>e.jsxs("p",{className:"text-sm text-red-600 dark:text-red-400",children:["• ",s]},t))})]}),e.jsx("button",{type:"submit",disabled:y,className:"w-full bg-orange-600 text-white py-3 px-4 rounded-lg hover:bg-orange-700 focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:y?"Resetting Password...":"Reset Password"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(f,{to:"/login",className:"text-orange-600 hover:text-orange-700 font-medium text-sm",children:"← Back to Sign In"})})]})})};export{B as default};
