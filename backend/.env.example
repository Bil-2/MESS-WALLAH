# ============================================
# MESS WALLAH - PRODUCTION SECURITY CONFIGURATION
# ============================================

# Database Configuration
MONGODB_URI=mongodb://localhost:27017/mess-wallah
DB_NAME=mess-wallah

# Server Configuration
NODE_ENV=development
PORT=5001
CLIENT_URL=http://localhost:5173
FRONTEND_URL=http://localhost:5173

# ============================================
# JWT SECURITY (CRITICAL - CHANGE IN PRODUCTION)
# ============================================
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=your-super-secret-jwt-key-min-64-characters-change-this-in-production
JWT_EXPIRE=7d
JWT_COOKIE_EXPIRE=7

# ============================================
# ENCRYPTION (CRITICAL - CHANGE IN PRODUCTION)
# ============================================
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ENCRYPTION_KEY=your-32-byte-encryption-key-change-this-in-production
SESSION_SECRET=your-session-secret-key-change-this-in-production
CSRF_SECRET=your-csrf-secret-key-change-this-in-production

# ============================================
# PAYMENT GATEWAY - RAZORPAY
# ============================================
RAZORPAY_KEY_ID=your_razorpay_key_id
RAZORPAY_KEY_SECRET=your_razorpay_key_secret
RAZORPAY_WEBHOOK_SECRET=your_razorpay_webhook_secret

# ============================================
# TWILIO SMS OTP
# ============================================
TWILIO_ACCOUNT_SID=your_twilio_account_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_VERIFY_SERVICE_SID=your_twilio_verify_service_sid
TWILIO_PHONE_NUMBER=your_twilio_phone_number

# ============================================
# EMAIL CONFIGURATION
# ============================================
# Option 1: SendGrid (Recommended for production)
SENDGRID_API_KEY=your_sendgrid_api_key

# Option 2: Gmail SMTP
GMAIL_USER=your_email@gmail.com
GMAIL_PASS=your_gmail_app_password

FROM_EMAIL=noreply@messwallah.com
SUPPORT_EMAIL=support@messwallah.com

# ============================================
# SECURITY CONFIGURATION
# ============================================
BCRYPT_ROUNDS=12
OTP_EXPIRY_MINUTES=10
SESSION_TIMEOUT_MINUTES=30
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_TIME_MINUTES=15

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
AUTH_RATE_LIMIT_MAX=10
PAYMENT_RATE_LIMIT_MAX=20
OTP_RATE_LIMIT_MAX=5

# ============================================
# CORS CONFIGURATION
# ============================================
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# ============================================
# LOGGING
# ============================================
LOG_LEVEL=info
LOG_FILE_PATH=./logs/app.log
ENABLE_SECURITY_LOGGING=true
ENABLE_AUDIT_TRAIL=true

# ============================================
# GOOGLE OAUTH (Optional)
# ============================================
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_CALLBACK_URL=http://localhost:5001/api/auth/google/callback

# ============================================
# PRODUCTION SECURITY FLAGS
# ============================================
SECURE_COOKIES=true
TRUST_PROXY=true
FORCE_HTTPS=true

# ============================================
# FILE UPLOAD SECURITY
# ============================================
MAX_FILE_SIZE_MB=5
MAX_UPLOAD_FILES=10
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/webp

# ============================================
# MONITORING (Optional)
# ============================================
SENTRY_DSN=your_sentry_dsn
ALERT_EMAIL=security@messwallah.com
